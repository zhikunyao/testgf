# Python 三消游戏

一个使用pygame开发的经典三消游戏，支持Android主流版本概念的游戏设计。

## 功能特性

- 🎮 **10x10网格**: 随机生成5种柔和颜色的色块
- 🎯 **智能消除**: 点击2个或以上连接的同色块进行消除
- 📊 **实时统计**: 记录分数和消除数量
- 🪐 **物理掉落**: 消除后色块自然掉落
- 🔨 **道具系统**: 锤子道具可直接敲碎单个色块
- ✨ **消除特效**: 消除时的视觉效果
- 🏆 **黄金色块**: 每次普通消除后在附近生成特殊黄金色块，拥有华丽的动态闪光效果，2个黄金消除获得1000分
- 💎 **钻石色块**: 每次黄金消除后在附近生成超级钻石色块，拥有绚丽多彩的超华丽效果，2个钻石消除获得10000分
- 🌈 **彩色万能色块**: 3个或以上钻石消除后生成，可与任何色块连接消除，拥有炫目彩虹效果，消除获得5000分
- 🐚 **珍珠色块**: 彩色色块消除后生成终极奖励色块，拥有优雅珍珠光泽效果，消除获得15000分
- 📝 **日志记录**: 详细记录点击和消除操作
- 🔄 **游戏重置**: 按R键重新开始
- ⚙️ **配置切换**: 按T键切换自动填充模式

## 安装运行

### 1. 安装依赖
```bash
pip3 install -r requirements.txt
```

### 2. 运行游戏
```bash
python3 match_three_game.py
```

## 游戏操作

### 基本操作
- **鼠标左键点击**: 选择色块或消除连接的同色块
- **道具点击**: 点击下方锤子道具使用锤子模式，再点击色块直接敲碎
- **R键**: 重置游戏

### 游戏规则
1. 点击色块时，系统会自动检测连接的同色块
2. 如果连接的同色块数量≥2个，则可以消除
3. 消除后上方色块会掉落填补空位，同时从上方掉落新色块填满10x10网格
4. **锤子道具机制**：初始拥有3个锤子，可以直接敲碎任何单个色块（每次使用获得50分）
5. **特殊色块五级升级机制**：
   - **普通消除** → 生成黄金色块 ✨
   - **黄金消除** → 生成钻石色块 💎
   - **3+钻石消除** → 生成彩色万能色块 🌈
   - **彩色消除** → 生成珍珠色块 🐚
   - **珍珠消除** → 终极奖励，不再生成新色块
7. **黄金色块特性**：
   - 华丽的动态视觉效果：外部光晕、闪烁边框、动态高光、星光特效
   - 2个或以上连接的黄金色块消除时，每个获得1000分 🏆
8. **钻石色块特性**：
   - 超华丽的多层动态效果：多重光晕、彩虹边框、旋转切面、星光射线、爆发光点
   - 更快的闪烁频率，更加炫目
   - 2个或以上连接的钻石色块消除时，每个获得10000分 💎
   - **特殊触发**：3个或以上连接消除时生成彩色万能色块
9. **彩色万能色块特性**：
   - 炫目的彩虹动态效果：七色光晕、旋转边框、彩虹漩涡
   - **万能特性**：可与任何色块连接消除
   - 2个或以上连接的彩色色块消除时，每个获得5000分 🌈
10. **珍珠色块特性**：
    - 优雅的珍珠光泽效果：渐变光晕、移动高光、珍珠图案
    - 终极奖励色块，消除时每个获得15000分 🐚
11. 掉落完成后可以继续游戏
12. **计分规则**：
    - 普通色块：每个10分
    - 黄金色块：每个1000分
    - 钻石色块：每个10000分  
    - 彩色色块：每个5000分
    - 珍珠色块：每个15000分

### 视觉效果
- **柔和色彩**: 使用柔和的颜色，减少视觉疲劳
- **黄金特效**: 黄金色块拥有华丽的动态闪光效果，包括光晕、闪烁边框、动态高光和星光特效 ✨💫
- **钻石特效**: 钻石色块拥有超华丽的五层动态效果，包括多重光晕、彩虹边框、旋转切面、星光射线和爆发光点 💎🌈
- **彩色特效**: 彩色万能色块拥有炫目的彩虹效果，包括七色光晕、旋转彩虹边框、中心彩虹漩涡 🌈✨
- **珍珠特效**: 珍珠色块拥有优雅的光泽效果，包括渐变光晕、移动高光、同心圆珍珠图案 🐚💫
- **选中状态**: 白色边框显示当前选中的色块
- **消除效果**: 消除时色块会放大并渐隐
- **掉落状态**: 掉落期间显示"Falling..."提示
- **空位显示**: 被消除位置暂时显示黑色背景
- **优化UI**: 分数最大显示9999999+，避免界面重叠，合理布局各项信息
- **立体圆角**: 普通色块采用圆角立体设计，增强视觉层次感

## 技术实现

### 核心算法
- **连通性检测**: 使用广度优先搜索(BFS)算法检测连接的同色块
- **掉落物理**: 按列处理色块的重力掉落
- **状态管理**: 使用状态机管理游戏状态(PLAYING/FALLING)
- **智能特殊色块生成**: 
  - 五级升级链：普通→黄金→钻石→彩色→珍珠
  - 避免在已有特殊色块位置重复生成，保持游戏平衡
  - 特殊触发机制：3+钻石消除触发彩色色块生成
- **五级计分系统**: 普通(10) → 黄金(1000) → 钻石(10000) → 彩色(5000) → 珍珠(15000)
- **四重动画系统**: 
  - 黄金：sin函数周期性闪光效果(0.1频率)
  - 钻石：更快频率闪光效果(0.15频率)，五层视觉特效
  - 彩色：最快频率彩虹效果(0.2频率)，七色旋转光晕
  - 珍珠：优雅脉动效果(0.08频率)，光泽移动高光
- **万能连接算法**: 彩色色块可与任何色块类型连接消除
- **优化UI显示**: 分数限制在9999999+以内，防止界面元素重叠
- **立体圆角渲染**: 普通色块使用多层高光阴影效果，创造立体视觉感

### 日志功能
游戏会自动生成`match_three_game.log`文件，记录：
- 游戏初始化和结束
- 玩家点击坐标
- 消除操作的坐标和数量
- 分数变化（包括黄金和钻石色块特殊奖励）
- 特殊色块生成位置和替换信息：
  - ✨ 黄金色块生成
  - 💎 钻石色块生成
  - 🌈 彩色万能色块生成
  - 🐚 珍珠色块生成
  - ⚠️ 生成失败警告（附近都是特殊色块时）
- 游戏状态转换

### 项目结构
```
testgf/
├── match_three_game.py    # 主游戏文件
├── requirements.txt       # Python依赖
├── README.md             # 项目说明
└── match_three_game.log  # 游戏日志(运行后生成)
```

## 系统要求

- Python 3.7+
- pygame 2.5.0+
- 支持图形界面的操作系统

## 开发说明

本项目使用面向对象设计，主要类结构：

- `MatchThreeGame`: 游戏主类
- `GameState`: 游戏状态枚举
- `Color`: 颜色定义枚举

代码遵循PEP8规范，包含详细的中文注释和类型提示。

## 游戏策略指南

### 🎯 进阶玩法
1. **入门策略**: 先消除普通色块生成黄金色块
2. **进阶策略**: 寻找机会连接2个或更多黄金色块，获得1000分奖励  
3. **高手策略**: 通过黄金消除生成钻石色块，连接钻石获得10000分
4. **专家策略**: 积累3个或更多钻石连消，触发彩色万能色块！
5. **大师策略**: 利用彩色色块的万能特性，与任何色块连消生成珍珠
6. **终极目标**: 打造普通→黄金→钻石→彩色→珍珠的完整五级升级链

### 💰 五级升级链效果
- 🔸 **普通消除**: 10分 + 生成黄金色块
- 🔸 **黄金消除**: 1000分 + 生成钻石色块  
- 🔸 **钻石消除**: 10000分 + (3+个时)生成彩色色块
- 🔸 **彩色消除**: 5000分 + 生成珍珠色块 + 万能连接
- 🔸 **珍珠消除**: 15000分 + 终极奖励特效

### 🎮 游戏体验
这个五级升级系统创造了史诗级的游戏体验：
- 🌟 每一步都有明确的升级目标
- 💎 越来越华丽的视觉特效震撼
- 🌈 彩色色块的万能特性带来策略革命
- 🐚 珍珠色块的终极奖励成就感爆棚
- 🚀 分数的几何级增长（最高单次15000分！）
- 🎯 深度策略规划增加无限重玩价值

每次游戏都是一场视觉盛宴和策略挑战！🎉✨💎🌈🐚